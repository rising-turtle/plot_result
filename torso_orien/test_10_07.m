clear 
clc
% data = [0,0.377864000000000,1.36867900000000,-0.926895000000000,0.288264000000000,1.36927400000000,-0.934483000000000,0.321753000000000,1.37020900000000,-0.971474000000000,0.319492000000000,1.36952200000000,-0.933165000000000,0.266650000000000,1.31825800000000,-0.927117000000000,0.174240000000000,1.71509900000000,0.00362500000000000,0.241664000000000,1.58656500000000,0.0104550000000000,0.228266000000000,1.72272900000000,0.00741800000000000,0.183598000000000,1.58312900000000,0.00660200000000000;0.00833300000000000,0.377869000000000,1.36868800000000,-0.926904000000000,0.288254000000000,1.36928000000000,-0.934494000000000,0.321753000000000,1.37021200000000,-0.971479000000000,0.319477000000000,1.36952200000000,-0.933153000000000,0.266648000000000,1.31827800000000,-0.927060000000000,0.174327000000000,1.71505400000000,0.00368400000000000,0.241760000000000,1.58652400000000,0.0106630000000000,0.228387000000000,1.72268700000000,0.00765800000000000,0.183687000000000,1.58309400000000,0.00672800000000000;0.0166670000000000,0.377879000000000,1.36867400000000,-0.926908000000000,0.288268000000000,1.36928000000000,-0.934493000000000,0.321752000000000,1.37020200000000,-0.971479000000000,0.319490000000000,1.36952500000000,-0.933165000000000,0.266641000000000,1.31828100000000,-0.927045000000000,0.174391000000000,1.71501100000000,0.00374100000000000,0.241852000000000,1.58648200000000,0.0109100000000000,0.228492000000000,1.72263800000000,0.00785300000000000,0.183781000000000,1.58305100000000,0.00687500000000000;0.0250000000000000,0.377869000000000,1.36867800000000,-0.926900000000000,0.288266000000000,1.36928300000000,-0.934496000000000,0.321756000000000,1.37020100000000,-0.971476000000000,0.319486000000000,1.36952300000000,-0.933156000000000,0.266643000000000,1.31826600000000,-0.927071000000000,0.174436000000000,1.71497400000000,0.00383200000000000,0.241919000000000,1.58645200000000,0.0111540000000000,0.228555000000000,1.72261000000000,0.00807700000000000,0.183864000000000,1.58301000000000,0.00704600000000000;0.0333330000000000,0.377868000000000,1.36869000000000,-0.926899000000000,0.288257000000000,1.36928800000000,-0.934491000000000,0.321755000000000,1.37021100000000,-0.971476000000000,0.319488000000000,1.36952900000000,-0.933155000000000,0.266642000000000,1.31825100000000,-0.927069000000000,0.174463000000000,1.71495800000000,0.00391900000000000,0.241977000000000,1.58643300000000,0.0114040000000000,0.228602000000000,1.72259300000000,0.00828200000000000,0.183925000000000,1.58298600000000,0.00722800000000000;0.0416670000000000,0.377873000000000,1.36868500000000,-0.926898000000000,0.288262000000000,1.36927500000000,-0.934487000000000,0.321755000000000,1.37021400000000,-0.971478000000000,0.319469000000000,1.36952300000000,-0.933143000000000,0.266651000000000,1.31826200000000,-0.927041000000000,0.174479000000000,1.71493300000000,0.00406200000000000,0.242045000000000,1.58639600000000,0.0116660000000000,0.228619000000000,1.72258000000000,0.00848600000000000,0.183968000000000,1.58297100000000,0.00742100000000000;0.0500000000000000,0.377870000000000,1.36868800000000,-0.926906000000000,0.288262000000000,1.36926500000000,-0.934483000000000,0.321754000000000,1.37020100000000,-0.971479000000000,0.319483000000000,1.36953000000000,-0.933164000000000,0.266649000000000,1.31827000000000,-0.927057000000000,0.174477000000000,1.71492400000000,0.00423300000000000,0.242048000000000,1.58639800000000,0.0118610000000000,0.228605000000000,1.72255900000000,0.00869000000000000,0.183996000000000,1.58296000000000,0.00757500000000000;0.0583330000000000,0.377864000000000,1.36868000000000,-0.926895000000000,0.288249000000000,1.36927200000000,-0.934491000000000,0.321752000000000,1.37020500000000,-0.971481000000000,0.319475000000000,1.36951700000000,-0.933147000000000,0.266652000000000,1.31824000000000,-0.927119000000000,0.174444000000000,1.71493900000000,0.00442100000000000,0.242059000000000,1.58643200000000,0.0120290000000000,0.228558000000000,1.72257600000000,0.00892900000000000,0.184003000000000,1.58298100000000,0.00771700000000000;0.0666670000000000,0.377852000000000,1.36867800000000,-0.926901000000000,0.288266000000000,1.36927800000000,-0.934490000000000,0.321753000000000,1.37020800000000,-0.971485000000000,0.319483000000000,1.36951700000000,-0.933152000000000,0.266658000000000,1.31824100000000,-0.927133000000000,0.174392000000000,1.71498200000000,0.00463300000000000,0.242042000000000,1.58647600000000,0.0121680000000000,0.228480000000000,1.72262300000000,0.00917200000000000,0.183995000000000,1.58301400000000,0.00783300000000000;0.0750000000000000,0.377870000000000,1.36868300000000,-0.926911000000000,0.288260000000000,1.36928000000000,-0.934493000000000,0.321756000000000,1.37020300000000,-0.971480000000000,0.319477000000000,1.36951800000000,-0.933150000000000,0.266664000000000,1.31826900000000,-0.927072000000000,0.174333000000000,1.71504200000000,0.00483600000000000,0.242003000000000,1.58652800000000,0.0123060000000000,0.228400000000000,1.72268200000000,0.00941200000000000,0.183960000000000,1.58306600000000,0.00793900000000000;0.0833330000000000,0.377862000000000,1.36869100000000,-0.926911000000000,0.288270000000000,1.36927800000000,-0.934495000000000,0.321755000000000,1.37020900000000,-0.971478000000000,0.319488000000000,1.36952300000000,-0.933161000000000,0.266668000000000,1.31827000000000,-0.927065000000000,0.174257000000000,1.71512700000000,0.00500800000000000,0.241950000000000,1.58661500000000,0.0124540000000000,0.228323000000000,1.72277300000000,0.00962400000000000,0.183923000000000,1.58314700000000,0.00805300000000000;0.0916670000000000,0.377866000000000,1.36868100000000,-0.926894000000000,0.288264000000000,1.36928100000000,-0.934484000000000,0.321752000000000,1.37021800000000,-0.971481000000000,0.319479000000000,1.36952200000000,-0.933150000000000,0.266665000000000,1.31824400000000,-0.927108000000000,0.174187000000000,1.71522700000000,0.00523700000000000,0.241862000000000,1.58670000000000,0.0126050000000000,0.228215000000000,1.72288800000000,0.00983700000000000,0.183862000000000,1.58324600000000,0.00819900000000000;0.100000000000000,0.377864000000000,1.36868400000000,-0.926891000000000,0.288260000000000,1.36928600000000,-0.934490000000000,0.321752000000000,1.37021400000000,-0.971480000000000,0.319490000000000,1.36952600000000,-0.933154000000000,0.266643000000000,1.31826100000000,-0.927015000000000,0.174082000000000,1.71531800000000,0.00543000000000000,0.241754000000000,1.58678700000000,0.0127690000000000,0.228084000000000,1.72298300000000,0.0100580000000000,0.183784000000000,1.58332300000000,0.00831000000000000;0.108333000000000,0.377883000000000,1.36868000000000,-0.926909000000000,0.288279000000000,1.36927200000000,-0.934488000000000,0.321756000000000,1.37020800000000,-0.971487000000000,0.319493000000000,1.36951800000000,-0.933164000000000,0.266655000000000,1.31825900000000,-0.927014000000000,0.173942000000000,1.71539400000000,0.00567800000000000,0.241648000000000,1.58685400000000,0.0129190000000000,0.227924000000000,1.72305900000000,0.0103400000000000,0.183669000000000,1.58339400000000,0.00846500000000000;0.116667000000000,0.377865000000000,1.36866900000000,-0.926893000000000,0.288273000000000,1.36926300000000,-0.934482000000000,0.321756000000000,1.37020200000000,-0.971480000000000,0.319490000000000,1.36951500000000,-0.933155000000000,0.266659000000000,1.31823800000000,-0.927075000000000,0.173818000000000,1.71547400000000,0.00588500000000000,0.241528000000000,1.58694100000000,0.0130560000000000,0.227768000000000,1.72317000000000,0.0105350000000000,0.183559000000000,1.58347800000000,0.00861100000000000];
M = csvread('gt_07.csv');
data = M(:,2:end);
[row_num,pt_num] = size(data);
newline = zeros(1,3*8+1);
pt_num = (pt_num -1 )/3;
marker = zeros(pt_num,3);
newPair = [];

for i=1:row_num
    foundT = 0;
    foundP = 0;
    for j=1:pt_num
        marker(j,:) = data(i, (3*j-1):(3*j+1) );
    end
  
    for j=1:pt_num
        if (foundT == 0)
            findUpPt = find( abs (vecnorm( (marker- marker(j,:))')-.04)<0.002 );
            findRgtPt = find( abs (vecnorm( (marker- marker(j,:))')-.03)<0.002); 
            findLftPt = find( abs (vecnorm( (marker- marker(j,:))')-.06)<0.002); 
            
            if ( (findUpPt>0) & (findRgtPt>0) & (findLftPt>0))
                foundT = 1;
                newline(1:13) = [data(i,1) marker(findUpPt,:) marker(findRgtPt,:) marker(j,:) marker(findLftPt,:)];	
            end
            
        end

        
        if (foundP == 0)
            findSTopRgtPt = find( abs (vecnorm( (marker- marker(j,:))')-.055)<0.002 );
            findSBotPt = find( abs (vecnorm( (marker- marker(j,:))')-.1356)<0.002); 
            findSBotRgtPt = find( abs (vecnorm( (marker- marker(j,:))')-.1464) <0.002); 
            if ( (findSTopRgtPt>0) & (findSBotPt>0) & (findSBotRgtPt>0))
                foundP = 1;
                newline(14:25) = [marker(j,:) marker(findSTopRgtPt,:) marker(findSBotPt,:) marker(findSBotRgtPt,:)];	
            end 
        end
        
        if ( (foundT>0) & (foundP>0))
            newPair = [newPair;newline];
            break;
        end
    end
    
end

csvwrite("gt_seq_07.csv", newPair);
